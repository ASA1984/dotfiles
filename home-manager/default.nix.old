{ user, stateVersion, pkgs, home-manager, ... }:
let
  home-common = {
    home = {
      username = user;
      homeDirectory = "/home/${user}";
      inherit pkgs stateVersion;
    };
    programs.home-manager.enable = true;
  };

  home-profile={}: home-manager.lib.homeManagerConfiguration {
    inherit pkgs;
    extraSpecialArgs={inherit user stateVersion;}
    
  };
  
in
{
  nixos = home-manager.lib.homeManagerConfiguration
    {
      extraSpecialArgs = { inherit user stateVersion pkgs; };
      modules = [
        home-common
        (import ./profiles/desktop.nix)
      ];
    };
}
